<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<script
  data-goatcounter="https://todepond.goatcounter.com/count"
  async
  src="//gc.zgo.at/count.js"
></script>
<title>Todepond dot com</title>
<link rel="shortcut icon" href="/favicon.png" />
<meta property="og:image" content="https://todepond.com/og.png" />
<meta property="og:title" content="Todepond dot com" />
<meta name="twitter:card" content="summary_large_image" />
<meta name="twitter:title" content="Todepond dot com" />
<meta name="twitter:description" content="" />
<meta name="twitter:image" content="https://todepond.com/og.png" />

<link rel="stylesheet" href="/style.css" />

<h1>Counter Two</h1>

<p>
  This is another counter. Push the buttons to change the number for
  <em>everyone</em>.
</p>

<h3><span id="count"></span></h3>

<button id="decrement">-</button>
<button id="increment">+</button>
<style>
  button {
    width: 40px;
  }
</style>

<script type="module">
  const incrementButton = document.getElementById("increment");
  const decrementButton = document.getElementById("decrement");
  const countSpan = document.getElementById("count");

  let baseCount = getLocalCount();
  let diffCount = 0;
  countSpan.textContent = baseCount + diffCount;

  getRemoteCount().then((remoteCount) => {
    baseCount = remoteCount;
    countSpan.textContent = baseCount + diffCount;
  });

  function getLocalCount() {
    return parseInt(localStorage.getItem("lab-counter-two") || "0");
  }

  function setLocalCount(count) {
    localStorage.setItem("lab-counter-two", count);
  }

  async function getRemoteCount() {
    const response = await fetch(
      "https://todepond-getLabCounterTwo.web.val.run"
    );
    return await response.json();
  }

  incrementButton.addEventListener("click", async () => {
    diffCount++;
    countSpan.textContent = baseCount + diffCount;
  });

  decrementButton.addEventListener("click", async () => {
    diffCount--;
    countSpan.textContent = baseCount + diffCount;
  });
</script>
